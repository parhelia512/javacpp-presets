// Targeted by JavaCPP version 1.5.13-SNAPSHOT: DO NOT EDIT THIS FILE

package org.bytedeco.onnxruntime;

import java.nio.*;
import org.bytedeco.javacpp.*;
import org.bytedeco.javacpp.annotation.*;

import static org.bytedeco.javacpp.presets.javacpp.*;
import org.bytedeco.opencl.*;
import static org.bytedeco.opencl.global.OpenCL.*;
import org.bytedeco.dnnl.*;
import static org.bytedeco.dnnl.global.dnnl.*;

import static org.bytedeco.onnxruntime.global.onnxruntime.*;


/**
 * \brief The OrtInteropApi struct provides functions for external resource interop with execution providers.
 *
 * This API enables importing external GPU resources (memory and semaphores) for zero-copy sharing
 * between ORT inference and other GPU workloads (e.g., D3D12 applications, media pipelines).
 *
 * The API is designed to be EP-agnostic and can be extended to support various GPU interop mechanisms
 * (D3D12 shared handles, CUDA external memory, Vulkan, etc.).
 *
 * Example usage (error handling not shown):
 *   const OrtInteropApi* interop_api = ort_api->GetInteropApi();
 *   OrtExternalResourceImporter* importer = NULL;
 *
 *   status = interop_api->CreateExternalResourceImporterForDevice(ep_device, &importer);
 *   if (importer == nullptr) {
 *     // External resource import is optional for EPs to implement
 *     return;
 *   }
 *   bool can_import = false;
 *   status = interop_api->CanImportMemory(importer, ORT_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE, &can_import);
 *   if (can_import) {
 *     OrtExternalMemoryHandle* mem_handle = NULL;
 *     status = interop_api->ImportMemory(importer, &mem_desc, &mem_handle);
 *     // ... use mem_handle to create tensors ...
 *     interop_api->ReleaseExternalMemoryHandle(mem_handle);
 *   }
 *   interop_api->ReleaseExternalResourceImporter(importer);
 *
 * @since Version 1.24.
 */
@Properties(inherit = org.bytedeco.onnxruntime.presets.onnxruntime.class)
public class OrtInteropApi extends Pointer {
    static { Loader.load(); }
    /** Default native constructor. */
    public OrtInteropApi() { super((Pointer)null); allocate(); }
    /** Native array allocator. Access with {@link Pointer#position(long)}. */
    public OrtInteropApi(long size) { super((Pointer)null); allocateArray(size); }
    /** Pointer cast constructor. Invokes {@link Pointer#Pointer(Pointer)}. */
    public OrtInteropApi(Pointer p) { super(p); }
    private native void allocate();
    private native void allocateArray(long size);
    @Override public OrtInteropApi position(long position) {
        return (OrtInteropApi)super.position(position);
    }
    @Override public OrtInteropApi getPointer(long i) {
        return new OrtInteropApi((Pointer)this).offsetAddress(i);
    }

  /** \name OrtExternalResourceImporter
   *  \{
  <p>
  /** \brief Create an external resource importer for a specific EP device.
   *
   * The external resource importer is a capability object that provides methods for importing
   * external GPU memory and semaphores for zero-copy import with an execution provider.
   *
   * This is an optional EP capability. If the EP does not support external resource import,
   * out_importer is set to nullptr and the function returns success (nullptr status).
   * This allows callers to use the simple "if (status != nullptr) handle_error()" pattern
   * and check out_importer separately for capability detection.
   *
   * @param ep_device [in] The OrtEpDevice instance to create the importer for.
   * @param out_importer [out] Output parameter set to the created OrtExternalResourceImporter instance,
   *                          or nullptr if the EP does not support external resource import.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus CreateExternalResourceImporterForDevice(
                    @Const OrtEpDevice ep_device,
                    @Cast("OrtExternalResourceImporter**") PointerPointer out_importer);
  public native OrtStatus CreateExternalResourceImporterForDevice(
                    @Const OrtEpDevice ep_device,
                    @ByPtrPtr OrtExternalResourceImporter out_importer);

  /** \brief Release an OrtExternalResourceImporter instance.
   *
   * @param input [in] The OrtExternalResourceImporter instance to release. May be nullptr.
   *
   * @since Version 1.24.
   */
  public native void ReleaseExternalResourceImporter(OrtExternalResourceImporter input);

  /** \}
   *  \name Memory Import
   *  \{
  <p>
  /** \brief Check if the external resource importer can import a specific memory handle type.
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param handle_type [in] The type of external memory handle to check.
   * @param out_supported [out] Set to true if the handle type is supported.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus CanImportMemory(
                    @Const OrtExternalResourceImporter importer,
                    @Cast("OrtExternalMemoryHandleType") int handle_type,
                    @Cast("bool*") BoolPointer out_supported);
  public native OrtStatus CanImportMemory(
                    @Const OrtExternalResourceImporter importer,
                    @Cast("OrtExternalMemoryHandleType") int handle_type,
                    @Cast("bool*") boolean[] out_supported);

  /** \brief Import external memory into the execution provider.
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param desc [in] Descriptor containing the external memory handle and properties.
   * @param out_handle [out] Output parameter set to the created OrtExternalMemoryHandle.
   *                        The caller owns the returned handle and must call ReleaseExternalMemoryHandle to free it.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus ImportMemory(
                    OrtExternalResourceImporter importer,
                    @Const OrtExternalMemoryDescriptor desc,
                    @Cast("OrtExternalMemoryHandle**") PointerPointer out_handle);
  public native OrtStatus ImportMemory(
                    OrtExternalResourceImporter importer,
                    @Const OrtExternalMemoryDescriptor desc,
                    @ByPtrPtr OrtExternalMemoryHandle out_handle);

  /** \brief Release an OrtExternalMemoryHandle instance.
   *
   * @param input [in] The OrtExternalMemoryHandle instance to release. May be nullptr.
   *
   * @since Version 1.24.
   */
  public native void ReleaseExternalMemoryHandle(OrtExternalMemoryHandle input);

  /** \brief Create a tensor backed by imported external memory.
   *
   * The created tensor is a view over the imported memory and does not copy data.
   * The OrtExternalMemoryHandle must remain valid for the lifetime of the tensor.
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param mem_handle [in] The imported external memory handle.
   * @param tensor_desc [in] Descriptor specifying tensor element type, shape, and optional offset.
   * @param out_tensor [out] Output parameter set to the created OrtValue containing the tensor.
   *                        The caller owns the returned tensor and must call ReleaseValue to free it.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus CreateTensorFromMemory(
                    OrtExternalResourceImporter importer,
                    @Const OrtExternalMemoryHandle mem_handle,
                    @Const OrtExternalTensorDescriptor tensor_desc,
                    @Cast("OrtValue**") PointerPointer out_tensor);
  public native OrtStatus CreateTensorFromMemory(
                    OrtExternalResourceImporter importer,
                    @Const OrtExternalMemoryHandle mem_handle,
                    @Const OrtExternalTensorDescriptor tensor_desc,
                    @ByPtrPtr OrtValue out_tensor);

  /** \}
   *  \name Semaphore Import
   *  \{
  <p>
  /** \brief Check if the external resource importer can import a specific semaphore type.
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param type [in] The type of external semaphore to check.
   * @param out_supported [out] Set to true if the semaphore type is supported.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus CanImportSemaphore(
                    @Const OrtExternalResourceImporter importer,
                    @Cast("OrtExternalSemaphoreType") int type,
                    @Cast("bool*") BoolPointer out_supported);
  public native OrtStatus CanImportSemaphore(
                    @Const OrtExternalResourceImporter importer,
                    @Cast("OrtExternalSemaphoreType") int type,
                    @Cast("bool*") boolean[] out_supported);

  /** \brief Import an external semaphore into the execution provider.
   *
   * The returned OrtExternalSemaphoreHandle can be used with WaitSemaphore and an OrtSyncStream
   * to synchronize execution with external operations.
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param desc [in] Descriptor containing the external semaphore handle and type.
   * @param out_handle [out] Output parameter set to the created OrtExternalSemaphoreHandle.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus ImportSemaphore(
                    OrtExternalResourceImporter importer,
                    @Const OrtExternalSemaphoreDescriptor desc,
                    @Cast("OrtExternalSemaphoreHandle**") PointerPointer out_handle);
  public native OrtStatus ImportSemaphore(
                    OrtExternalResourceImporter importer,
                    @Const OrtExternalSemaphoreDescriptor desc,
                    @ByPtrPtr OrtExternalSemaphoreHandle out_handle);

  /** \brief Release an OrtExternalSemaphoreHandle instance.
   *
   * @param input [in] The OrtExternalSemaphoreHandle instance to release. May be nullptr.
   *
   * @since Version 1.24.
   */
  public native void ReleaseExternalSemaphoreHandle(OrtExternalSemaphoreHandle input);

  /** \brief Wait on an external semaphore on the EP's stream.
   *
   * Inserts a wait operation into the EP's stream that blocks until the semaphore
   * reaches the specified value. This is used to synchronize with external GPU work
   * (e.g., D3D12 timeline fence).
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param semaphore_handle [in] The imported external semaphore.
   * @param stream [in] The OrtSyncStream to wait on.
   * @param value [in] The fence/semaphore value to wait for.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus WaitSemaphore(
                    OrtExternalResourceImporter importer,
                    OrtExternalSemaphoreHandle semaphore_handle,
                    OrtSyncStream stream,
                    @Cast("uint64_t") long value);

  /** \brief Signal an external semaphore from the EP's stream.
   *
   * Inserts a signal operation into the EP's stream that sets the semaphore
   * to the specified value when reached. This is used to notify external GPU work
   * (e.g., D3D12 timeline fence) that ORT inference is complete.
   *
   * @param importer [in] The OrtExternalResourceImporter instance.
   * @param semaphore_handle [in] The imported external semaphore.
   * @param stream [in] The OrtSyncStream to signal from.
   * @param value [in] The fence/semaphore value to signal.
   *
   * \snippet{doc} snippets.dox OrtStatus Return Value
   *
   * @since Version 1.24.
   */
  public native OrtStatus SignalSemaphore(
                    OrtExternalResourceImporter importer,
                    OrtExternalSemaphoreHandle semaphore_handle,
                    OrtSyncStream stream,
                    @Cast("uint64_t") long value);

  /** \} */
}
